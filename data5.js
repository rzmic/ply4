function t(t,e,o,s,n){const r=[];return t.source1&&""!==t.source1&&""!==e&&r.push({default:!0,html:"Server UC",url:e}),t.source2&&""!==t.source2&&""!==o&&r.push({html:"Torrent",url:o}),t.source3&&""!==t.source3&&""!==s&&r.push({html:"Server M4#NM",url:s}),t.source4&&""!==t.source4&&""!==n&&r.push({html:"Server M4#N",url:n}),r}function e(t){const e=decodeURIComponent(t),[o,s]=e.split("?"),n=new URL(o);n.pathname=n.pathname.replace(/~hls\/index\.m3u8/,"");const r=new URLSearchParams(s);return r.set("download","true"),r.set("download-id","ff2a6057a95adc2765d1e2bab355291e"),`${n.href}?${r.toString()}`}document.addEventListener("DOMContentLoaded",(async function(){const o=new URLSearchParams(window.location.search);let s=o.get("id");const n=o.get("sub");if(!s)return document.querySelector(".loading-container").style.display="none",void(document.querySelector(".error-message").style.display="flex");let r="",l=!1;if(s.startsWith("tt"))try{idtv=s.split("-")[0],season_number=s.split("-")[1],episode_number=s.split("-")[2];const t=await fetch(`https://api.themoviedb.org/3/find/${idtv}?api_key=712478bf12bb1fae1212625634c4ec0e&external_source=imdb_id`);if(!t.ok)throw new Error("Failed to convert IMDb ID to TMDB ID");{const e=await t.json();if(!(e.tv_results&&e.tv_results.length>0))throw new Error("No TMDB ID found for the provided IMDb ID");r=e.tv_results[0].id+"-"+season_number+"-"+episode_number,tmdbid=e.tv_results[0].id,l=!0}}catch(p){return document.querySelector(".loading-container").style.display="none",void(document.querySelector(".error-message").style.display="flex")}else r=s,tmdbid=s.split("-")[0],season_number=s.split("-")[1],episode_number=s.split("-")[2],l=!0;let i="",a="",c="",u="",d=!1;try{const o=await fetch(`https://db.ply4.com/tvs/${r}`);if(o.ok){const s=await o.json();let r=s.titletv;const l=r.match(/\((\d{4})\)$/);if(year=l?l[1]:"",the_title=r.replace(/\s*\(\d{4}\)$/,"").trim(),i=s.source1,s.source2&&""!==s.source2){const t=s.source2.match(/https:\/\/watercache\.nanobytes\.org\/get\/([a-f0-9]{40})\/.*/);if(t&&t[1]){const e=`https://webtor.io/${t[1]}`;try{const t=await fetch(`https://s2.ply4.com/?url=${encodeURIComponent(e)}`);if(t.ok){const e=await t.json();a=e.m3u8Link}}catch(p){}}}c=s.source3||"",u=s.source4||"";const h=t(s,i,a,c,u);i||a||c||u?(d=!0,art=new Artplayer({container:".rplayer-pro",url:i||a||c||u,setting:!0,fullscreen:!0,playsInline:!0,hotkey:!0,aspectRatio:!0,autoOrientation:!0,autoPlayback:!0,theme:"#0056B3",subtitle:{url:n||"",style:{color:"#fff","font-size":"calc(2vw + 12px)","margin-bottom":"4vw","@media (max-width: 576px)":{"font-size":"14px","margin-bottom":"20px"}}},settings:[{width:200,html:"Subtitle",tooltip:"AutoSubtitle",icon:'<img width="22" height="22" src="https://artplayer.org/assets/img/subtitle.svg">',selector:[{html:"Display",tooltip:"Show",switch:!0,onSwitch:function(t){return t.tooltip=t.switch?"Hide":"Show",art.subtitle.show=!t.switch,!t.switch}},...await fetch("https://ply4.com/lang2.json").then((t=>t.json())).then((t=>t.map((t=>({html:t.name,iso:t.iso,url:""})))))],onSelect:async function(t){try{const e=await fetch(`https://subdl.ply4.com/tv?tmdbid=${tmdbid}&season_number=${season_number}&episode_number=${episode_number}&iso=${t.iso}`);if(e.ok){const o=`${await e.text()}`;return art.subtitle.switch(o,{name:t.html}),t.html}}catch(p){}}}],controls:[{position:"right",html:"DD",index:1,tooltip:"Direct Download",style:{marginRight:"10px"},click:function(){if(a){const t=e(a);window.open(t,"_blank")}else alert("Direct Download is not available")}},{position:"right",html:"TD",index:1,tooltip:"Torrent Download",style:{marginRight:"10px"},click:function(){source2Urldownload=s.source2,source2Urldownload?window.open(source2Urldownload,"_blank"):alert("Torrent Download is not available")}}],plugins:[artplayerPluginHlsQuality({control:!1,setting:!0,getResolution:t=>t.height+"P",title:"Quality",auto:"Auto"}),artplayerPluginChromecast({})],customType:{m3u8:function(t,e,o){if(Hls.isSupported()){o.hls&&o.hls.destroy();const s=new Hls;s.loadSource(e),s.attachMedia(t),o.hls=s,o.on("destroy",(()=>s.destroy()))}else t.canPlayType("application/vnd.apple.mpegurl")?t.src=e:o.notice.show="Unsupported playback format: m3u8"}},quality:h}),document.querySelector(".rplayer-pro").style.display="block"):d=!1,document.querySelector(".loading-container").style.display="none",d||(document.querySelector(".error-message").style.display="flex")}else document.querySelector(".loading-container").style.display="none",document.querySelector(".error-message").style.display="flex"}catch(p){document.querySelector(".loading-container").style.display="none",document.querySelector(".error-message").style.display="flex"}}));
