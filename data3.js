let t,e,o;function r(t,e,o,r,s){const l=[];return t.source1&&""!==t.source1&&""!==e&&l.push({default:!0,html:"Server UC",url:proxy1+e}),t.source2&&""!==t.source2&&""!==o&&l.push({html:"Torrent",url:proxy2+o}),t.source3&&""!==t.source3&&""!==r&&l.push({html:"Server M4#NM",url:proxy3+r}),t.source4&&""!==t.source4&&""!==s&&l.push({html:"Server M4#N",url:proxy4+s}),l}document.addEventListener("DOMContentLoaded",(async function(){const s=new URLSearchParams(window.location.search);let l=s.get("id");const n=s.get("sub");if(!l)return document.querySelector(".loading-container").style.display="none",void(document.querySelector(".error-message").style.display="flex");let i="",c=!1;if(l.startsWith("tt"))try{const t=await fetch(`https://api.themoviedb.org/3/find/${l}?api_key=712478bf12bb1fae1212625634c4ec0e&external_source=imdb_id`);if(!t.ok)throw new Error("Failed to convert IMDb ID to TMDB ID");{const e=await t.json();if(!(e.movie_results&&e.movie_results.length>0))throw new Error("No TMDB ID found for the provided IMDb ID");i=e.movie_results[0].id,c=!0}}catch(h){return document.querySelector(".loading-container").style.display="none",void(document.querySelector(".error-message").style.display="flex")}else i=l,c=!0;let a="",u="",y="",p="",d=!1;try{const s=await fetch(`https://db.ply4.com/movies/${i}`);if(s.ok){const l=await s.json();let c=l.title;if(o=c.match(/\((\d{4})\)$/)[1],e=c.replace(/\s*\(\d{4}\)$/,"").trim(),a=l.source1,l.source2&&""!==l.source2){const t=l.source2.replace(/https:\/\/yts.mx\/torrent\/download\/(.+)$/,"https://webtor.io/$1");try{const e=await fetch(`https://s2.ply4.com/?url=${encodeURIComponent(t)}`);if(e.ok){u=(await e.json()).m3u8Link}}catch(h){}}y=l.source3||"",p=l.source4||"";const m=r(l,a,u,y,p);a||u||y||p?(d=!0,t=new Artplayer({container:".rplayer-pro",url:a||u||y||p,setting:!0,fullscreen:!0,playsInline:!0,hotkey:!0,aspectRatio:!0,autoOrientation:!0,autoPlayback:!0,theme:"#0056B3",subtitle:{url:n||"",style:{color:"#fff","font-size":"calc(2vw + 12px)","margin-bottom":"4vw","@media (max-width: 576px)":{"font-size":"14px","margin-bottom":"20px"}}},settings:[{width:200,html:"Subtitle",tooltip:"AutoSubtitle",icon:'<img width="22" height="22" src="https://artplayer.org/assets/img/subtitle.svg">',selector:[{html:"Display",tooltip:"Show",switch:!0,onSwitch:function(e){return e.tooltip=e.switch?"Hide":"Show",t.subtitle.show=!e.switch,!e.switch}},...await fetch("https://ply4.com/lang2.json").then((t=>t.json())).then((t=>t.map((t=>({html:t.name,iso:t.iso,url:""})))))],onSelect:async function(e){try{const o=await fetch(`https://subdl.ply4.com/?tmdbid=${i}&iso=${e.iso}`);if(o.ok){const r=`${await o.text()}`;return t.subtitle.switch(r,{name:e.html}),e.html}}catch(h){}}}],plugins:[artplayerPluginHlsQuality({control:!1,setting:!0,getResolution:t=>t.height+"P",title:"Quality",auto:"Auto"}),artplayerPluginChromecast({})],customType:{m3u8:function(t,e,o){if(Hls.isSupported()){o.hls&&o.hls.destroy();const r=new Hls;r.loadSource(e),r.attachMedia(t),o.hls=r,o.on("destroy",(()=>r.destroy()))}else t.canPlayType("application/vnd.apple.mpegurl")?t.src=e:o.notice.show="Unsupported playback format: m3u8"}},quality:m}),document.querySelector(".rplayer-pro").style.display="block"):d=!1,document.querySelector(".loading-container").style.display="none",d||(document.querySelector(".error-message").style.display="flex")}else document.querySelector(".loading-container").style.display="none",document.querySelector(".error-message").style.display="flex"}catch(h){document.querySelector(".loading-container").style.display="none",document.querySelector(".error-message").style.display="flex"}}));
