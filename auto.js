function t(t){document.querySelector(".loading-container").style.display="none",document.querySelector(".error-message").style.display="flex",document.querySelector(".error-message").textContent=t,console.error(t)}function e(t,e){const o=[];return t&&o.push({default:!0,html:"Server UC",url:t}),e&&o.push({html:"Torrent",url:e}),o}function o(t){const e=decodeURIComponent(t),[o,n]=e.split("?");let i=o.replace(/\.mp4~vod/,".zip").replace(/\/hls\/[a-z0-9]+\/index\.m3u8/,"").replace(/\[YTS\.MX\]/,"[YTS.MX]~arch");const a=encodeURI(i),r=encodeURIComponent(n);return decodeURIComponent(`${a}?${r}`)}document.addEventListener("DOMContentLoaded",(async function(){const n=new URLSearchParams(window.location.search),i=n.get("id"),a=n.get("sub");if(!i)return void t("No ID provided in URL");let r="",l="",s=!1;try{if(i.startsWith("tt")){const t=await fetch(`https://api.themoviedb.org/3/find/${i}?api_key=712478bf12bb1fae1212625634c4ec0e&external_source=imdb_id`),e=await t.json();if(!(e.movie_results&&e.movie_results.length>0))throw new Error("No TMDB ID found for the provided IMDb ID");r=e.movie_results[0].id,l=i,s=!0}else{r=i,s=!0;const t=await fetch(`https://api.themoviedb.org/3/movie/${r}/external_ids?api_key=712478bf12bb1fae1212625634c4ec0e`);l=(await t.json()).imdb_id}}catch(u){return void t("Error fetching movie data: "+u.message)}if(!l)return void t("IMDb ID not found");let c="",d="",p=!1;try{const n=await fetch(`https://p.ply4.com/${r}`);c=(await n.json()).playlist;const i=await fetch(`https://yts.mx/api/v2/movie_details.json?imdb_id=${encodeURIComponent(l)}`),s=await i.json(),m=s.data.movie.torrents[0].url,h=s.data.movie.torrents[0].url.replace(/https:\/\/yts.mx\/torrent\/download\/(.+)$/,"https://webtor.io/$1"),y=await fetch(`https://s2.ply4.com/?url=${encodeURIComponent(h)}`),f=await y.json();d=f.m3u8Link;const g=e(c,d);if(c||d){p=!0;const t=new Artplayer({container:".rplayer-pro",url:c||d,setting:!0,fullscreen:!0,playsInline:!0,hotkey:!0,aspectRatio:!0,autoOrientation:!0,autoPlayback:!0,theme:"#0056B3",subtitle:{url:a||"",style:{color:"#fff","font-size":"calc(2vw + 12px)","margin-bottom":"4vw","@media (max-width: 576px)":{"font-size":"14px","margin-bottom":"20px"}}},settings:[{width:200,html:"Subtitle",tooltip:"AutoSubtitle",icon:'<img width="22" height="22" src="https://artplayer.org/assets/img/subtitle.svg">',selector:await fetch("https://ply4.com/lang2.json").then((t=>t.json())).then((t=>t.map((t=>({html:t.name,iso:t.iso,url:""}))))),onSelect:async function(e){try{const o=await fetch(`https://subdl.ply4.com/?tmdbid=${r}&iso=${e.iso}`),n=await o.text();return t.subtitle.switch(n,{name:e.html}),e.html}catch(u){console.error("Error loading subtitle:",u)}}}],controls:[{position:"right",html:"DD",index:1,tooltip:"Direct Download",style:{marginRight:"10px"},click:function(){if(d){const t=o(d);window.open(t,"_blank")}else alert("Direct Download is not available")}},{position:"right",html:"TD",index:1,tooltip:"Torrent Download",style:{marginRight:"10px"},click:function(){d?window.open(m,"_blank"):alert("Torrent Download is not available")}}],plugins:[artplayerPluginHlsQuality({control:!1,setting:!0,getResolution:t=>t.height+"P",title:"Quality",auto:"Auto"}),artplayerPluginChromecast({})],customType:{m3u8:function(t,e,o){if(Hls.isSupported()){o.hls&&o.hls.destroy();const n=new Hls;n.loadSource(e),n.attachMedia(t),o.hls=n,o.on("destroy",(()=>n.destroy()))}else t.canPlayType("application/vnd.apple.mpegurl")?t.src=e:o.notice.show="Unsupported playback format: m3u8"}},quality:g});document.querySelector(".rplayer-pro").style.display="block",document.querySelector(".loading-container").style.display="none"}else t("No valid playback URL found")}catch(u){t("Error fetching movie details: "+u.message)}}));
